(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-34a00c40"],{2423:function(t,e,i){"use strict";i.d(e,"j",(function(){return n})),i.d(e,"b",(function(){return s})),i.d(e,"g",(function(){return o})),i.d(e,"k",(function(){return r})),i.d(e,"h",(function(){return l})),i.d(e,"c",(function(){return c})),i.d(e,"a",(function(){return u})),i.d(e,"i",(function(){return d})),i.d(e,"d",(function(){return g})),i.d(e,"l",(function(){return p})),i.d(e,"e",(function(){return f})),i.d(e,"f",(function(){return m}));var a=i("b775");function n(t){return a["a"].post("/article/save",t)}function s(t){return a["a"].get("/article/detail/".concat(t))}function o(t){return a["a"].get("/article/page",{params:t})}function r(t){return Object(a["a"])({url:"/article/status/update",method:"post",params:t})}function l(t){return a["a"].get("/article/published/page",{params:t})}function c(t){return a["a"].delete("/article/delete/".concat(t))}function u(t){return Object(a["a"])({url:"/article/recommend/save",method:"post",params:t})}function d(){return a["a"].get("/article/recommend/list")}function g(t){return a["a"].delete("/article/recommend/delete/"+t)}function p(t){return a["a"].get("/article/view/"+t)}function f(t){return a["a"].put("/article/increment_view/"+t)}function m(t){return a["a"].get("/article/interrelated/list",{params:t})}},3463:function(t,e,i){},"3f5e":function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"b",(function(){return s}));var a=i("b775");function n(t){return a["a"].delete("/file/delete",{params:t})}function s(t){return a["a"].get("/file/page",{params:t})}},4626:function(t,e,i){"use strict";var a=i("8153"),n=i.n(a);n.a},6340:function(t,e,i){"use strict";var a=i("b4c3"),n=i.n(a);n.a},8153:function(t,e,i){},"92fc":function(t,e,i){},b4c3:function(t,e,i){},c405:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"d",(function(){return s})),i.d(e,"b",(function(){return o})),i.d(e,"e",(function(){return r})),i.d(e,"c",(function(){return l}));var a=i("b775");function n(t){return a["a"].post("/category/add",t)}function s(t){return a["a"].get("/category/page",{params:t})}function o(){return a["a"].get("/category/list")}function r(t){return Object(a["a"])({url:"/category/update",method:"post",params:t})}function l(t){return a["a"].delete("/category/delete/"+t)}},d28d:function(t,e,i){"use strict";i.d(e,"a",(function(){return n})),i.d(e,"c",(function(){return s})),i.d(e,"d",(function(){return o})),i.d(e,"e",(function(){return r})),i.d(e,"b",(function(){return l}));var a=i("b775");function n(t){return Object(a["a"])({url:"/tag/add",method:"post",params:t})}function s(t){return a["a"].get("/tag/page",{params:t})}function o(){return a["a"].get("/tag/list")}function r(t){return Object(a["a"])({url:"/tag/update",method:"post",params:t})}function l(t){return a["a"].delete("/tag/delete/"+t)}},de92:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"edit-container"},[i("div",{staticClass:"edit-head"},[i("el-button",{staticClass:"col",attrs:{size:"small",type:"danger"},on:{click:function(e){return t.save(0)}}},[t._v("发布")]),t._v(" "),i("el-button",{staticClass:"col",attrs:{size:"small",type:"warning"},on:{click:function(e){return t.save(1)}}},[t._v("保存")]),t._v(" "),t.cover?i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-picture"},on:{click:t.coverPreview}},[t._v("预览封面")]):i("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-upload"},on:{click:t.coverUploadClick}},[t._v("上传封面")]),t._v(" "),i("el-select",{staticClass:"col",staticStyle:{width:"120px"},attrs:{size:"small",placeholder:"选择分类"},model:{value:t.categoryId,callback:function(e){t.categoryId=e},expression:"categoryId"}},t._l(t.categorys,(function(t,e){return i("el-option",{key:e,attrs:{label:t.name,value:t.id}})})),1),t._v(" "),i("el-select",{staticClass:"col",staticStyle:{width:"75px"},attrs:{size:"small"},model:{value:t.original,callback:function(e){t.original=e},expression:"original"}},t._l(t.options,(function(t,e){return i("el-option",{key:e,attrs:{label:t.name,value:t.value}})})),1),t._v(" "),i("dynamic-tags",{attrs:{"seleted-tags":t.seletedTags},on:{tagsChage:t.tagsChage}})],1),t._v(" "),i("div",{staticClass:"row-box"},[i("div",{staticClass:"input-wrapper"},[i("p",{staticClass:"sub-title"},[t._v("标题")]),t._v(" "),i("el-input",{attrs:{placeholder:"输入文章标题"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1),t._v(" "),i("div",{staticClass:"input-wrapper"},[i("p",{staticClass:"sub-title"},[t._v("摘要")]),t._v(" "),i("el-input",{attrs:{placeholder:"输入文章摘要"},model:{value:t.summary,callback:function(e){t.summary=e},expression:"summary"}})],1),t._v(" "),0===t.original?i("div",{staticClass:"input-wrapper"},[i("p",{staticClass:"sub-title"},[t._v("转载地址")]),t._v(" "),i("el-input",{attrs:{placeholder:"输入转载地址"},model:{value:t.reproduce,callback:function(e){t.reproduce=e},expression:"reproduce"}})],1):t._e()]),t._v(" "),i("mavon-editor",{ref:"md",staticStyle:{"min-height":"600px"},attrs:{"code-style":"gradient-dark",ishljs:!0},on:{imgAdd:t.mdImgUpload,imgDel:t.mdImgDel,change:t.change,save:function(e){return t.save(1)}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),t._v(" "),i("img-upload",{attrs:{visible:t.imgUploadVisible},on:{dialogClose:t.dialogClose,uploadSuccess:t.coverUploadSuccess}}),t._v(" "),i("el-dialog",{attrs:{modal:!1,title:"预览封面",top:"25vh",visible:t.coverVisible,width:"320px","before-close":t.coverClose,"lock-scroll":!1},on:{"update:visible":function(e){t.coverVisible=e}}},[i("div",{staticClass:"cover-pre",staticStyle:{"text-align":"center",overflow:"hidden",position:"relative","border-radius":"4px"}},[i("img",{staticStyle:{height:"100%",width:"100%"},attrs:{src:t.cover}}),t._v(" "),i("i",{staticClass:"el-icon-delete",staticStyle:{position:"absolute",bottom:"2px",right:"10px","z-index":"999"},on:{click:t.delCover}})])])],1)},n=[],s=(i("7f7f"),i("92fc"),i("3463"),function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"tags-wrapper"},[t._l(t.dynamicTags,(function(e){return i("el-tag",{key:e.tagId,attrs:{closable:"","disable-transitions":!1},on:{close:function(i){return t.tagClose(e)}}},[t._v(t._s(e.value))])})),t._v(" "),t.inputTagVisible?i("el-autocomplete",{ref:"tagInput",staticStyle:{width:"111px","margin-left":"5px"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"输入关键字",size:"small"},on:{select:t.tagSelect},model:{value:t.inputTagValue,callback:function(e){t.inputTagValue=e},expression:"inputTagValue"}},[i("i",{staticClass:"el-icon-close",attrs:{slot:"suffix",title:"关闭"},on:{click:function(e){t.inputTagVisible=!1,t.inputTagValue=""}},slot:"suffix"})]):i("el-button",{staticStyle:{"margin-left":"5px"},attrs:{type:"primary",size:"small"},on:{click:t.showInputTag}},[t._v("+New Tag")])],2)}),o=[],r=i("d28d"),l={props:{seletedTags:{type:Array,required:!1,default:null}},data:function(){return{dynamicTags:this.seletedTags||[],inputTagVisible:!1,inputTagValue:"",tags:[]}},watch:{dynamicTags:function(t){this.$emit("tagsChage",t)}},mounted:function(){this.initTag()},methods:{initTag:function(){var t=this;Object(r["d"])().then((function(e){for(var i=e.data,a=i.length,n=0;n<a;n++)t.tags.push({value:i[n].name,tagId:i[n].id})}))},querySearch:function(t,e){var i=this.tags,a=t?i.filter(this.createFilter(t)):i;e(a)},createFilter:function(t){return function(e){return 0===e.value.toLowerCase().indexOf(t.toLowerCase())}},showInputTag:function(){var t=this;this.inputTagVisible=!0,this.$nextTick((function(e){t.$refs.tagInput.$refs.input.focus()}))},tagSelect:function(t){var e=this.dynamicTags.some((function(e){return e.tagId===t.tagId}));if(e)return this.inputTagValue="",this.inputTagVisible=!1,void this.$message.error("该标签已选择");var i=this.dynamicTags.length;if(i>3)return this.inputTagValue="",this.inputTagVisible=!1,void this.$message.error("最多能选4个标签");this.dynamicTags.push(t),this.inputTagValue="",this.inputTagVisible=!1},tagClose:function(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)}}},c=l,u=(i("4626"),i("2877")),d=Object(u["a"])(c,s,o,!1,null,"09bf130b",null),g=d.exports,p=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{modal:!1,title:"上传图片",top:"35vh",visible:t.visible,width:"350px","before-close":t.dialogClose,"lock-scroll":!1},on:{"update:visible":function(e){t.visible=e}}},[i("div",{staticStyle:{"text-align":"center"}},[i("el-upload",{ref:"upload",attrs:{action:t.path,"file-list":t.files,multiple:!1,limit:1,headers:t.headers,"auto-upload":!1,name:"file","on-exceed":t.onExceed,"before-upload":t.beforeUpload,"on-success":t.uploadSuccess,"on-error":t.uploadError}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",disabled:t.loading},slot:"trigger"},[t._v("选取文件")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"success",disabled:t.loading},on:{click:function(){t.$refs.upload.submit()}}},[t._v("上传文件")]),t._v(" "),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpeg/jpg/png文件，且不超过500kb")])],1)],1)])},f=[],m=i("5f87"),h={props:{visible:{type:Boolean,default:!1}},data:function(){return{path:"http://localhost:8080//file/upload",files:[],loading:!1}},computed:{headers:function(){var t={Authorization:"Bearer "+Object(m["a"])()};return t}},methods:{onExceed:function(){this.loading=!1},uploadSuccess:function(t,e,i){if(0!==t.code)return console.error(t.message),void this.$message.error("文件上传失败");this.$emit("uploadSuccess",t.data),this.loading=!1},uploadError:function(t){console.error(t),this.loading=!1,this.$message.error("文件上传失败")},beforeUpload:function(t){this.loading=!0;var e="image/jpeg"===t.type||"image/png"===t.type||"image/jpg"===t.type,i=t.size/1e3<500;return e||(this.$message.error("文件格式不正确"),this.loading=!1),i||(this.$message.error("文件大小不能大于500KB"),this.loading=!1),e&&i},dialogClose:function(){this.files=[],this.loading=!1,this.$emit("dialogClose")}}},v=h,b=Object(u["a"])(v,p,f,!1,null,null,null),y=b.exports,C=i("3f5e"),_=i("c405"),T=i("b775"),x=i("2423"),w=i("b2d8"),k=(i("64e1"),{name:"Edit",components:{DynamicTags:g,ImgUpload:y,mavonEditor:w["mavonEditor"]},data:function(){return{loading:!1,id:null,tagIds:[],categoryId:null,title:"",summary:"",reproduce:"",content:"",htmlContent:"",cover:"",coverVisible:!1,imgUploadVisible:!1,uploadType:1,original:1,options:[{name:"原创",value:1},{name:"转载",value:0}],categorys:[],seletedTags:[]}},mounted:function(){this.initCategoryList(),this.id=this.$route.query.id||null,this.initEdit()},methods:{change:function(t,e){this.htmlContent=e},initEdit:function(){var t=this;this.id&&(this.loading=!0,Object(x["b"])(this.id).then((function(e){t.categoryId=e.data.categoryId,t.title=e.data.title,t.summary=e.data.summary,t.cover=e.data.cover,t.content=e.data.content,t.original=e.data.original,t.reproduce=e.data.reproduce;for(var i=e.data.tagList,a=i.length,n=0;n<a;n++)t.seletedTags.push({value:i[n].name,tagId:i[n].id});t.loading=!1}),(function(e){console.error(e),t.loading=!1})))},initCategoryList:function(){var t=this;Object(_["b"])().then((function(e){t.categorys=e.data}))},tagsChage:function(t){this.tagIds=t.map((function(t){return t.tagId}))},coverUploadClick:function(){this.imgUploadVisible=!0},coverPreview:function(){this.coverVisible=!0},coverClose:function(){this.coverVisible=!1},delCover:function(){var t=this,e=this.cover;if(e){var i={fullPath:e};Object(C["a"])(i).then((function(e){t.$message({message:"删除成功",type:"success"}),t.coverVisible=!1,t.cover=""}))}},mdImgUpload:function(t,e){var i=this,a=new FormData;a.append("file",e),Object(T["a"])({url:"http://localhost:8080//file/upload",method:"post",data:a,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){i.$message({message:"图片上传成功",type:"success"}),i.$refs.md.$img2Url(t,e.data)}))},mdImgDel:function(t){if(t&&t[0]){var e={fullPath:t[0]};Object(C["a"])(e)}},dialogClose:function(){this.imgUploadVisible=!1},coverUploadSuccess:function(t){this.imgUploadVisible=!1;var e=this.cover;this.cover=t;var i={fullPath:e};e&&Object(C["a"])(i),this.$message({message:"封面上传成功",type:"success"})},save:function(t){var e=this;this.loading=!0;var i={id:this.id,status:t,title:this.title,content:this.content,htmlContent:this.htmlContent,cover:this.cover,summary:this.summary,original:this.original,reproduce:1===this.original?null:this.reproduce,categoryId:this.categoryId,tagIds:this.tagIds};Object(x["j"])(i).then((function(i){e.id=i.data,e.loading=!1,e.$message({message:0===t?"文章发布成功":"文章保存成功",type:"success"})}),(function(t){console.log(t),e.loading=!1}))}}}),I=k,V=(i("6340"),Object(u["a"])(I,a,n,!1,null,"4f06d21e",null));e["default"]=V.exports}}]);