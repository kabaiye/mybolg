(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-242791f1"],{"02f4":function(e,t,i){var a=i("4588"),s=i("be13");e.exports=function(e){return function(t,i){var n,r,o=String(s(t)),c=a(i),l=o.length;return c<0||c>=l?e?"":void 0:(n=o.charCodeAt(c),n<55296||n>56319||c+1===l||(r=o.charCodeAt(c+1))<56320||r>57343?e?o.charAt(c):n:e?o.slice(c,c+2):r-56320+(n-55296<<10)+65536)}}},"0390":function(e,t,i){"use strict";var a=i("02f4")(!0);e.exports=function(e,t,i){return t+(i?a(e,t).length:1)}},"0bfb":function(e,t,i){"use strict";var a=i("cb7c");e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"136f":function(e,t,i){"use strict";var a=i("e9c8"),s=i.n(a);s.a},"214f":function(e,t,i){"use strict";i("b0c5");var a=i("2aba"),s=i("32e9"),n=i("79e5"),r=i("be13"),o=i("2b4c"),c=i("520a"),l=o("species"),u=!n((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),p=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2===i.length&&"a"===i[0]&&"b"===i[1]}();e.exports=function(e,t,i){var f=o(e),d=!n((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),v=d?!n((function(){var t=!1,i=/a/;return i.exec=function(){return t=!0,null},"split"===e&&(i.constructor={},i.constructor[l]=function(){return i}),i[f](""),!t})):void 0;if(!d||!v||"replace"===e&&!u||"split"===e&&!p){var b=/./[f],h=i(r,f,""[e],(function(e,t,i,a,s){return t.exec===c?d&&!s?{done:!0,value:b.call(t,i,a)}:{done:!0,value:e.call(i,t,a)}:{done:!1}})),m=h[0],g=h[1];a(String.prototype,e,m),s(RegExp.prototype,f,2==t?function(e,t){return g.call(e,this,t)}:function(e){return g.call(e,this)})}}},3846:function(e,t,i){i("9e1e")&&"g"!=/./g.flags&&i("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:i("0bfb")})},"520a":function(e,t,i){"use strict";var a=i("0bfb"),s=RegExp.prototype.exec,n=String.prototype.replace,r=s,o="lastIndex",c=function(){var e=/a/,t=/b*/g;return s.call(e,"a"),s.call(t,"a"),0!==e[o]||0!==t[o]}(),l=void 0!==/()??/.exec("")[1],u=c||l;u&&(r=function(e){var t,i,r,u,p=this;return l&&(i=new RegExp("^"+p.source+"$(?!\\s)",a.call(p))),c&&(t=p[o]),r=s.call(p,e),c&&r&&(p[o]=p.global?r.index+r[0].length:t),l&&r&&r.length>1&&n.call(r[0],i,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(r[u]=void 0)})),r}),e.exports=r},"5f1b":function(e,t,i){"use strict";var a=i("23c6"),s=RegExp.prototype.exec;e.exports=function(e,t){var i=e.exec;if("function"===typeof i){var n=i.call(e,t);if("object"!==typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==a(e))throw new TypeError("RegExp#exec called on incompatible receiver");return s.call(e,t)}},"6b54":function(e,t,i){"use strict";i("3846");var a=i("cb7c"),s=i("0bfb"),n=i("9e1e"),r="toString",o=/./[r],c=function(e){i("2aba")(RegExp.prototype,r,e,!0)};i("79e5")((function(){return"/a/b"!=o.call({source:"a",flags:"b"})}))?c((function(){var e=a(this);return"/".concat(e.source,"/","flags"in e?e.flags:!n&&e instanceof RegExp?s.call(e):void 0)})):o.name!=r&&c((function(){return o.call(this)}))},a481:function(e,t,i){"use strict";var a=i("cb7c"),s=i("4bf8"),n=i("9def"),r=i("4588"),o=i("0390"),c=i("5f1b"),l=Math.max,u=Math.min,p=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g,v=function(e){return void 0===e?e:String(e)};i("214f")("replace",2,(function(e,t,i,b){return[function(a,s){var n=e(this),r=void 0==a?void 0:a[t];return void 0!==r?r.call(a,n,s):i.call(String(n),a,s)},function(e,t){var s=b(i,e,this,t);if(s.done)return s.value;var p=a(e),f=String(this),d="function"===typeof t;d||(t=String(t));var m=p.global;if(m){var g=p.unicode;p.lastIndex=0}var x=[];while(1){var y=c(p,f);if(null===y)break;if(x.push(y),!m)break;var k=String(y[0]);""===k&&(p.lastIndex=o(f,n(p.lastIndex),g))}for(var _="",C=0,w=0;w<x.length;w++){y=x[w];for(var I=String(y[0]),$=l(u(r(y.index),f.length),0),V=[],E=1;E<y.length;E++)V.push(v(y[E]));var S=y.groups;if(d){var B=[I].concat(V,$,f);void 0!==S&&B.push(S);var R=String(t.apply(void 0,B))}else R=h(I,f,$,V,S,t);$>=C&&(_+=f.slice(C,$)+R,C=$+I.length)}return _+f.slice(C)}];function h(e,t,a,n,r,o){var c=a+e.length,l=n.length,u=d;return void 0!==r&&(r=s(r),u=f),i.call(o,u,(function(i,s){var o;switch(s.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(c);case"<":o=r[s.slice(1,-1)];break;default:var u=+s;if(0===u)return i;if(u>l){var f=p(u/10);return 0===f?i:f<=l?void 0===n[f-1]?s.charAt(1):n[f-1]+s.charAt(1):i}o=n[u-1]}return void 0===o?"":o}))}}))},b0c5:function(e,t,i){"use strict";var a=i("520a");i("5ca1")({target:"RegExp",proto:!0,forced:a!==/./.exec},{exec:a})},e382:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"setting-box"},[i("h1",[e._v("个人信息")]),e._v(" "),i("ul",{staticClass:"setting-list"},[i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("头像")]),e._v(" "),i("div",{staticClass:"avatar-wrapper"},[i("img",{staticClass:"user-avatar",attrs:{src:e.userInfo.avatar||e.defaultAvatar}})]),e._v(" "),i("div",{staticClass:"action-box"},[i("div",{staticClass:"hint"},[e._v("支持 jpg、png 格式大小 300KB 以内的图片")]),e._v(" "),i("el-upload",{ref:"upload",attrs:{action:e.path,"file-list":e.files,multiple:!1,limit:1,headers:e.headers,"auto-upload":!0,name:"file","on-exceed":e.onExceed,"before-upload":e.beforeUpload,"on-success":e.uploadSuccess,"on-error":e.uploadError,"show-file-list":!1}},[i("el-button",{staticStyle:{padding:"5px 7px"},attrs:{loading:e.loading,type:"primary",size:"mini"}},[e._v("点击上传")])],1)],1)]),e._v(" "),i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("用户名")]),e._v(" "),i("div",{staticClass:"input-wrapper"},[i("el-input",{attrs:{disabled:"",placeholder:"未填写"},model:{value:e.userInfo.username,callback:function(t){e.$set(e.userInfo,"username",t)},expression:"userInfo.username"}})],1),e._v(" "),i("div",{staticClass:"action-box"},[e.userInfo.username?i("el-button",{staticStyle:{color:"#C0C4CC"},attrs:{type:"text",disabled:""}},[i("span",[i("i",{staticClass:"el-icon-lock"}),e._v("不可修改")])]):i("el-button",{attrs:{type:"text"},on:{click:e.usernamePrompt}},[i("span",[i("i",{staticClass:"el-icon-lock"}),e._v("立即填写")])])],1)]),e._v(" "),i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("昵称")]),e._v(" "),i("div",{staticClass:"input-wrapper"},[i("el-input",{ref:"nicknameIput",attrs:{placeholder:"填写你的昵称"},on:{focus:e.nicknameIputFocus},model:{value:e.form.nickname,callback:function(t){e.$set(e.form,"nickname",t)},expression:"form.nickname"}})],1),e._v(" "),i("div",{staticClass:"action-box"},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.opVisible.nickname,expression:"!opVisible.nickname"}],attrs:{type:"text"},on:{click:e.nicknameIputFocus}},[i("span",[i("i",{staticClass:"el-icon-edit"}),e._v("修改")])]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.opVisible.nickname,expression:"opVisible.nickname"}]},[i("el-button",{staticStyle:{color:"#999"},attrs:{type:"text"},on:{click:e.cancelNickname}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.saveNickname}},[e._v("保存")])],1)],1)]),e._v(" "),i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("手机号")]),e._v(" "),i("div",{staticClass:"input-wrapper"},[i("el-input",{attrs:{disabled:"",placeholder:"绑定手机号"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),e._v(" "),i("div",{staticClass:"action-box"},[e.form.mobile?i("router-link",{attrs:{to:"/rebind-mobile"}},[i("span",[i("i",{staticClass:"el-icon-mobile-phone"}),e._v("更改绑定")])]):i("router-link",{attrs:{to:"/bind-mobile"}},[i("span",[i("i",{staticClass:"el-icon-mobile-phone"}),e._v("立即绑定")])])],1)]),e._v(" "),i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("邮箱")]),e._v(" "),i("div",{staticClass:"input-wrapper"},[i("el-input",{attrs:{disabled:"",placeholder:"未绑定邮箱"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),e._v(" "),i("div",{staticClass:"action-box"},[i("router-link",{attrs:{type:"text",to:"/email-validate"}},[i("span",[i("i",{staticClass:"el-icon-message"}),e._v(e._s(e.form.email?"更改绑定":"立即绑定"))])])],1)]),e._v(" "),i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("生日")]),e._v(" "),i("div",{staticClass:"input-wrapper"},[i("el-date-picker",{ref:"birthdayIput",attrs:{type:"date","prefix-icon":"",placeholder:"选择日期",clearable:!1},on:{focus:e.birthdayIputFocus},model:{value:e.form.birthday,callback:function(t){e.$set(e.form,"birthday",t)},expression:"form.birthday"}})],1),e._v(" "),i("div",{staticClass:"action-box"},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.opVisible.birthday,expression:"!opVisible.birthday"}],attrs:{type:"text"},on:{click:e.birthdayIputFocus}},[i("span",[i("i",{staticClass:"el-icon-date"}),e._v("修改")])]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.opVisible.birthday,expression:"opVisible.birthday"}],staticStyle:{display:"flex"}},[i("el-button",{staticStyle:{color:"#999"},attrs:{type:"text"},on:{click:e.cancelBirthday}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.saveBirthday}},[e._v("保存")])],1)],1)]),e._v(" "),i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("性别")]),e._v(" "),i("div",{staticClass:"input-wrapper"},[i("el-select",{ref:"genderIput",attrs:{placeholder:"请选择"},on:{focus:e.genderIputFocus},model:{value:e.form.gender,callback:function(t){e.$set(e.form,"gender",t)},expression:"form.gender"}},e._l(e.options,(function(e){return i("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e._v(" "),i("div",{staticClass:"action-box"},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.opVisible.gender,expression:"!opVisible.gender"}],attrs:{type:"text"},on:{click:e.genderIputFocus}},[i("span",[i("i",{staticClass:"el-icon-female"}),e._v("修改")])]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.opVisible.gender,expression:"opVisible.gender"}]},[i("el-button",{staticStyle:{color:"#999"},attrs:{type:"text"},on:{click:e.cancelGender}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.saveGender}},[e._v("保存")])],1)],1)]),e._v(" "),i("li",{staticClass:"item"},[i("span",{staticClass:"label"},[e._v("简介")]),e._v(" "),i("div",{staticClass:"input-wrapper"},[i("el-input",{ref:"briefIput",attrs:{type:"textarea",rows:2,placeholder:"填写你的简介"},on:{focus:e.briefIputFocus},model:{value:e.form.brief,callback:function(t){e.$set(e.form,"brief",t)},expression:"form.brief"}})],1),e._v(" "),i("div",{staticClass:"action-box"},[i("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.opVisible.brief,expression:"!opVisible.brief"}],attrs:{type:"text"},on:{click:e.briefIputFocus}},[i("span",[i("i",{staticClass:"el-icon-edit"}),e._v("修改")])]),e._v(" "),i("span",{directives:[{name:"show",rawName:"v-show",value:e.opVisible.brief,expression:"opVisible.brief"}]},[i("el-button",{staticStyle:{color:"#999"},attrs:{type:"text"},on:{click:e.cancelBrief}},[e._v("取消")]),e._v(" "),i("el-button",{attrs:{type:"text"},on:{click:e.saveBrief}},[e._v("保存")])],1)],1)])])])])},s=[],n=(i("6b54"),i("a481"),i("96cf"),i("3b8d")),r=i("db72"),o=i("5880"),c=i("5f87"),l=i("c24f"),u={name:"User",data:function(){return{options:[{value:1,label:"男"},{value:0,label:"女"}],opVisible:{nickname:!1,birthday:!1,gender:!1,brief:!1},path:"http://localhost:8080/user/avatar/update",files:[],loading:!1,userInfo:"",form:{nickname:"",mobile:"",email:"",gender:0,birthday:"",brief:""}}},computed:Object(r["a"])({},Object(o["mapGetters"])(["defaultAvatar"]),{headers:function(){var e={Authorization:"Bearer "+Object(c["a"])()};return e}}),mounted:function(){this.init()},methods:{init:function(){var e=this.$store.getters.userInfo;this.userInfo=e,this.username=e.username,this.form.nickname=e.nickname,this.form.mobile=this.sensitiveMobile(e.mobile),this.form.email=this.sensitiveEmail(e.email),this.form.gender=e.gender,this.originalGender=e.gender,this.form.birthday=e.birthday,this.originalBirthday=e.birthday,this.form.brief=e.brief},nicknameIputFocus:function(){this.$refs.nicknameIput.focus(),this.opVisible.nickname=!0},cancelNickname:function(){this.form.nickname=this.userInfo.nickname,this.opVisible.nickname=!1},saveNickname:function(){var e={nickname:this.form.nickname,userId:this.userInfo.id};this.updateUser(e,0)},birthdayIputFocus:function(){this.opVisible.birthday=!0},cancelBirthday:function(){this.form.birthday=this.userInfo.birthday,this.opVisible.birthday=!1},saveBirthday:function(){var e={birthday:this.form.birthday,userId:this.userInfo.id};this.updateUser(e,1)},genderIputFocus:function(){this.$refs.genderIput.focus(),this.opVisible.gender=!0},cancelGender:function(){this.form.gender=this.userInfo.gender,this.opVisible.gender=!1},saveGender:function(){var e={gender:this.form.gender,userId:this.userInfo.id};this.updateUser(e,2)},briefIputFocus:function(){this.$refs.briefIput.focus(),this.opVisible.brief=!0},cancelBrief:function(){this.form.brief=this.userInfo.brief,this.opVisible.brief=!1},saveBrief:function(){var e={brief:this.form.brief,userId:this.userInfo.id};this.updateUser(e,3)},updateUser:function(e,t){var i=this;return new Promise(function(){var a=Object(n["a"])(regeneratorRuntime.mark((function a(s,n){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(l["o"])(e).then((function(e){switch(t){case 0:i.opVisible.nickname=!1;break;case 1:i.opVisible.birthday=!1;break;case 2:i.opVisible.gender=!1;break;case 3:i.opVisible.brief=!1;break}i.$message({message:"保存成功",type:"success"}),s()}),(function(e){n(e)}));case 2:return a.next=4,i.$store.dispatch("user/getUserInfo");case 4:i.init();case 5:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())},onExceed:function(){this.loading=!1},uploadSuccess:function(e,t,i){var a=this;if(0!==e.code)return console.error(e.message),void this.$message.error("文件上传失败");this.loading=!1,this.$message({message:"上传成功",type:"success"}),this.$store.dispatch("user/getUserInfo").then((function(e){return a.init()}))},uploadError:function(e){console.error(e),this.loading=!1,this.$message.error("文件上传失败")},beforeUpload:function(e){this.loading=!0;var t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type,i=e.size/1e3<300;return t||(this.$message.error("文件格式不正确"),this.loading=!1),i||(this.$message.error("文件大小不能大于300KB"),this.loading=!1),t&&i},usernamePrompt:function(){var e=this;this.$prompt("字母开头，允许2-16字节，允许字母数字下划线，并且用户名成功填写后不允许修改。","填写用户名",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[a-zA-Z][a-zA-Z0-9_]{1,15}$/,inputErrorMessage:"用户名格式不正确"}).then((function(t){var i=t.value,a={username:i};Object(l["d"])(a).then((function(t){e.$message({message:"绑定成功",type:"success"}),e.$store.dispatch("user/getUserInfo").then((function(t){return e.init()}))}))})).catch((function(){}))},sensitiveEmail:function(e){return e?e.substr(0,2)+"****"+e.substr(e.indexOf("@")):""},sensitiveMobile:function(e){var t=/(\d{3})\d*(\d{4})/;return e?e.toString().replace(t,"$1****$2"):""}}},p=u,f=(i("136f"),i("2877")),d=Object(f["a"])(p,a,s,!1,null,"08f381f2",null);t["default"]=d.exports},e9c8:function(e,t,i){}}]);